CREATE TABLE products_backup AS 
SELECT * FROM products;

PRAGMA foreign_keys = ON;


DROP TABLE products;

CREATE TABLE products (
    id TEXT PRIMARY KEY UNIQUE NOT NULL,
    name TEXT NOT NULL,
    description TEXT,
    price DECIMAL(10, 2) NOT NULL,
    stock INTEGER NOT NULL,
    created_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    category_id INTEGER,
    color_id INTEGER,
    size_id INTEGER,
    gender_id INTEGER,
    active BOOLEAN DEFAULT TRUE,
    FOREIGN KEY (category_id) REFERENCES categories(category_id),
    FOREIGN KEY (color_id) REFERENCES colors(color_id),
    FOREIGN KEY (size_id) REFERENCES sizes(size_id),
    FOREIGN KEY (gender_id) REFERENCES genders(gender_id)
);


INSERT INTO products (id, name, description, price, stock, created_at, category_id, color_id, size_id, gender_id, active)
SELECT id, name, description, price, stock, created_at, category_id, color_id, size_id, gender_id, active
FROM products_backup;


DROP TABLE products_backup;


-----------------------------------------------------------------------

PRAGMA foreign_keys = OFF;

CREATE TABLE categories_backup AS SELECT * FROM categories;
CREATE TABLE colors_backup AS SELECT * FROM colors;
CREATE TABLE sizes_backup AS SELECT * FROM sizes;
CREATE TABLE genders_backup AS SELECT * FROM genders;


DROP TABLE categories;
DROP TABLE colors;
DROP TABLE sizes;
DROP TABLE genders;


CREATE TABLE categories (
    category_id INTEGER PRIMARY KEY AUTOINCREMENT,
    name TEXT NOT NULL
);

CREATE TABLE colors (
    color_id INTEGER PRIMARY KEY AUTOINCREMENT,
    name TEXT NOT NULL,
    hex_code TEXT  -- Adicionando a coluna para o c√≥digo hexadecimal
);


CREATE TABLE sizes (
    size_id INTEGER PRIMARY KEY AUTOINCREMENT,
    name TEXT NOT NULL
);


CREATE TABLE genders (
    gender_id INTEGER PRIMARY KEY AUTOINCREMENT,
    name TEXT NOT NULL
);


INSERT INTO categories (category_id, name)
SELECT category_id, name FROM categories_backup;

ALTER TABLE categories
ADD COLUMN description TEXT;



INSERT INTO colors (color_id, name, hex_code)  -- Incluindo a coluna hex_code
SELECT color_id, name, hex_code FROM colors_backup;

INSERT INTO sizes (size_id, name)
SELECT size_id, name FROM sizes_backup;

INSERT INTO genders (gender_id, name)
SELECT gender_id, name FROM genders_backup;

DROP TABLE categories_backup;
DROP TABLE colors_backup;
DROP TABLE sizes_backup;
DROP TABLE genders_backup;

PRAGMA foreign_keys = ON;
